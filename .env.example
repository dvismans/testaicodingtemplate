# =============================================================================
# SAUNA CONTROL SYSTEM - Environment Configuration
# Copy this file to .env and fill in your values
# =============================================================================

# --- Server Configuration ---
PORT=8083
NODE_ENV=development
APP_NAME=SaunaControl
LOG_LEVEL=info

# --- MCB Device Configuration ---
# Device ID used by Tuya Cloud API for command routing
MCB_DEVICE_ID=your_device_id

# Python MCB Local API endpoint for fast status polling
# This is the separate Tuya-MCB-API service
MCB_LOCAL_API_URL=http://127.0.0.1:8091

# --- Tuya Cloud API Configuration ---
# Get these from Tuya IoT Platform: https://iot.tuya.com/
TUYA_ACCESS_ID=your_access_id
TUYA_ACCESS_KEY=your_access_key
TUYA_BASE_URL=https://openapi.tuyaeu.com

# --- Smart Meter Configuration ---
# External API for reading phase amperage (L1, L2, L3)
SMART_METER_URL=http://192.168.x.x:port/api/meter
SMART_METER_API_KEY=your_api_key

# Threshold in Amps - MCB will auto-shutdown if any phase exceeds this
AMPERAGE_THRESHOLD=25

# Polling interval in milliseconds
POLLING_INTERVAL_MS=5000

# Cooldown after auto-shutdown before another can trigger (ms)
SWITCH_OFF_COOLDOWN_MS=10000

# --- MQTT Configuration ---
MQTT_BROKER_URL=mqtt://192.168.x.x:1883

# MQTT Topics for sensor subscriptions
MQTT_TOPIC_DOOR=homelab/sensors/sauna/door/#
MQTT_TOPIC_RUUVI=homelab/sensors/sauna/ruuvi/#
MQTT_TOPIC_VENTILATOR=homelab/sensors/sauna/ventilator/#
MQTT_TOPIC_FLIC=homelab/controls/sauna/flic/#

# --- Ventilator (Shelly Relay) Configuration ---
# Set to false to disable ventilator control entirely
VENTILATOR_ENABLED=true

# Shelly device IP address
SHELLY_VENTILATOR_IP=192.168.x.x

# Minutes to keep ventilator running after MCB turns OFF
VENTILATOR_DELAY_OFF_MINUTES=60

# Minutes between keep-alive cycles (Shelly auto-off prevention)
VENTILATOR_KEEP_ALIVE_MINUTES=25

# HTTP timeout for Shelly commands in milliseconds
VENTILATOR_TIMEOUT_MS=5000

# --- WhatsApp Notifications (WAHA) ---
# WAHA (WhatsApp HTTP API) server endpoint
WAHA_SERVER=http://192.168.x.x:3002

# API key for WAHA authentication (optional)
WAHA_API_KEY=your_api_key

# Phone number to receive notifications (WhatsApp format)
NOTIFICATION_PHONE=31612345678

# --- Feature Flags ---
# Enable safety auto-shutdown on over-amperage
ENABLE_SAFETY_SHUTDOWN=true

# Enable WhatsApp notifications
ENABLE_NOTIFICATIONS=true
